<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>üéØ WinGo Predictor Pro</title>
<link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="#000000">

<style>
:root{
  --gold:#ffd900; --gold-2:#f3c14a;
  --ink:#e8ecf3; --muted:#a9b2c3;
  --glass: rgba(10,12,16,.65);
  --card: rgba(16,20,28,.68);
  --stroke: rgba(255,255,255,.08);
  --ok:#22c55e; --warn:#f59e0b; --bad:#ef4444;
  --r:16px; --shadow:0 10px 28px rgba(0,0,0,.45);
}

/* Background */
html,body{height:100%}
body{
  margin:0; color:#fff; font:16px/1.45 ui-sans-serif,system-ui,Segoe UI,Roboto,Arial;
  background: #000 url("https://i.imgur.com/5pX8Z2y.gif") center/cover fixed no-repeat; /* subtle stars */
}
body:before{
  content:""; position:fixed; inset:0;
  background: radial-gradient(90em 60em at 10% -10%,rgba(255,217,0,.12),transparent),
              radial-gradient(60em 40em at 90% 110%,rgba(243,193,74,.10),transparent),
              linear-gradient(180deg,rgba(0,0,0,.35),rgba(0,0,0,.75));
  pointer-events:none; z-index:-1;
}

/* Header */
header{position:sticky; top:0; z-index:10; background:#0b0b0b; border-bottom:1px solid #1a1a1a}
.brand{
  max-width:980px; margin:0 auto; padding:10px 14px;
  display:flex; align-items:center; gap:10px; justify-content:center;
  color:var(--gold); font-weight:900; letter-spacing:.3px;
  text-transform:uppercase; font-size:clamp(16px,3.8vw,20px);
}
.brand .dot{width:10px;height:10px;border-radius:50%;background:var(--gold);box-shadow:0 0 14px var(--gold)}

/* Layout */
.container{max-width:980px;margin:18px auto;padding:0 14px}
.card{
  background:var(--card); border:1px solid var(--stroke); border-radius:var(--r);
  box-shadow:var(--shadow); padding:16px; backdrop-filter: blur(6px);
}
.grid{display:grid; grid-template-columns:1.3fr .9fr; gap:14px}
@media (max-width:820px){.grid{grid-template-columns:1fr}}

label{display:block;color:#dfe5f0;font-size:13px;font-weight:700;margin:0 0 6px}
input,select{
  width:100%; padding:14px 14px; border-radius:12px; background:rgba(8,10,14,.85);
  color:#fff; border:2px solid #202636; outline:none; font-size:16px;
}
input:focus,select:focus{border-color:var(--gold)}
.sub{color:var(--muted);font-size:12px;margin-top:6px}

.row{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
.btn{
  border:0; border-radius:12px; cursor:pointer; font-weight:900;
  padding:12px 16px; box-shadow:0 10px 18px rgba(255,217,0,.15);
  background:linear-gradient(180deg,var(--gold),var(--gold-2)); color:#000;
}
.btn.sec{background:#1d2636;color:#e7edf8;border:1px solid #2b3448; box-shadow:none}
.btn.tiny{padding:10px 12px; font-size:.92rem}

/* Result */
.result{
  display:grid; grid-template-columns:1fr .7fr; gap:14px; margin-top:14px;
}
@media (max-width:820px){.result{grid-template-columns:1fr}}
.tile{background:rgba(255,255,255,.06); border:1px solid var(--stroke); border-radius:12px; padding:14px}
.key{color:#9fb0c7;font-size:12px}
.value{font-size:28px;font-weight:900;color:var(--gold)}
.line{height:10px;background:#223047;border-radius:999px;overflow:hidden;margin:8px 0 4px}
.bar{height:10px;width:0%;background:linear-gradient(90deg,var(--gold-2),var(--gold))}

/* Pills + history */
.pill{display:inline-block;padding:6px 10px;border-radius:999px;border:1px solid #2a3448;font-weight:800;margin-right:6px}
.ok{color:var(--ok)} .warn{color:var(--warn)} .bad{color:var(--bad)}
.history{max-height:220px;overflow:auto;color:#cfd7e6;font-size:12px}
.hrow{padding:6px 0;border-bottom:1px dashed rgba(255,255,255,.08)}

/* Footer hint */
.hint{color:#9fb0c7;font-size:12px;margin-top:10px;text-align:center}
</style>
</head>
<body>
<header>
  <div class="brand"><span class="dot"></span> WINGO PREDICTOR PRO</div>
</header>

<div class="container">
  <!-- Controls -->
  <div class="card">
    <div class="grid">
      <div>
        <label for="period">üßæ Period Number</label>
        <input id="period" placeholder="e.g. 20250813100052810" inputmode="numeric" autocomplete="off"/>
        <div class="sub">‡§ï‡•á‡§µ‡§≤ digits (0‚Äì9) ‚Ä¢ tail ‡§ñ‡•Å‡§¶-‡§¨-‡§ñ‡•Å‡§¶ ‡§¶‡§ø‡§ñ‡•á‡§ó‡§æ</div>
      </div>
      <div>
        <label>‚è± Auto mode</label>
        <div class="row">
          <select id="interval" aria-label="Interval">
            <option value="30">30 seconds</option>
            <option value="60">1 minute</option>
          </select>
          <button class="btn tiny" id="btnAuto">‚ñ∂ Start Auto</button>
          <button class="btn sec tiny" id="notifyBtn">üîî Notifications</button>
        </div>
        <div class="sub" id="periodInfo">‚Äî</div>
      </div>
    </div>

    <div class="row" style="margin-top:12px">
      <button class="btn" id="btnPredict">üîÆ Predict</button>
      <button class="btn sec" id="btnClear">Clear</button>
      <button class="btn sec" id="btnCopy">Copy</button>
    </div>

    <!-- Result -->
    <div class="result" id="resultWrap" style="display:none">
      <div class="tile">
        <div class="key">Predicted Number</div>
        <div class="value" id="vNum">‚Äî</div>
        <div class="key" style="margin-top:6px">Size</div>
        <div class="value" id="vSize">‚Äî</div>
      </div>
      <div class="tile">
        <div class="key">Confidence</div>
        <div class="line"><div class="bar" id="confBar"></div></div>
        <div class="key" style="margin-top:8px">Signal</div>
        <span id="playSignal" class="pill">‚Äî</span>
      </div>
    </div>

    <!-- History -->
    <div class="tile" style="margin-top:14px">
      <div class="key" style="font-weight:800">üïò Recent Predictions</div>
      <div id="hist" class="history">‚Äî</div>
    </div>
    <div class="hint">Tip: Auto ON + Notifications ‡§∞‡§ñ‡•á‡§Ç‡•§ ‡§®‡§Ø‡§æ period ‡§Ü‡§®‡•á ‡§™‡§∞ popup + sound ‡§¨‡§ú‡•á‡§ó‡§æ‡•§</div>
  </div>
</div>

<!-- 1-second coin chime -->
<audio id="coinSound" preload="auto"
src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_0a9b0f58b1.mp3?filename=coin-199621.mp3"></audio>

<script>
/* ---------- helpers ---------- */
const el=id=>document.getElementById(id);
const isDigits=s=>/^\d+$/.test(s||"");
const clamp01=x=>Math.max(0,Math.min(1,x));
const normalize=a=>{const s=a.reduce((p,c)=>p+c,0)||1;return a.map(x=>x/s);};
const argmax=a=>a.indexOf(Math.max(...a));
const bump=p=>{try{return (BigInt(p)+1n).toString()}catch{const a=p.split('').map(n=>+n);for(let i=a.length-1;i>=0;i--){if(a[i]===9)a[i]=0;else{a[i]++;break;}}return a.join('')}};
const tail4=p=>String(p).slice(-4);

/* deterministic RNG (not last digit based) */
function hash32(str){let h=2166136261>>>0;for(let i=0;i<str.length;i++){h^=str.charCodeAt(i);h=Math.imul(h,16777619)}return h>>>0;}
function mulberry32(seed){return function(){let t=seed+=0x6D2B79F5;t=Math.imul(t^t>>>15,t|1);t^=t+Math.imul(t^t>>>7,t|61);return((t^t>>>14)>>>0)/4294967296}}

/* ---------- pattern priors (anti-linear) ---------- */
function priorBase(period){
  if(!isDigits(period)) return Array(10).fill(0.1);
  const d=[...period].map(Number);
  const s=d.reduce((a,b)=>a+b,0), mod10=s%10, mod7=s%7;
  const rev=(+([...period].reverse().join('')))%10;
  const mir=(+([...period].map(x=>9-x).join('')))%10;
  const cont=(d[d.length-1]+1)%10;
  const seedDigit=hash32(period+'seed')%10;

  const v=Array(10).fill(0.05);
  v[mod10]+=0.35;             // checksum-ish
  v[(mod7*3)%10]+=0.18;       // cyclic
  v[(mod7*5)%10]+=0.16;
  v[rev]+=0.14;               // reverse
  v[mir]+=0.12;               // mirror
  v[cont]+=0.10;              // continuous
  // hashed distance (breaks 0..9 ramp)
  for(let i=0;i<10;i++){
    const dist=Math.min((i-seedDigit+10)%10,(seedDigit-i+10)%10);
    v[i]+=0.22*Math.exp(-0.55*dist);
  }
  return normalize(v);
}

function priorAntiSequence(period){
  if(!isDigits(period)) return Array(10).fill(0.1);
  const last=+period.slice(-1);
  const v=Array(10).fill(0.1);
  // Down-weight immediate neighbours to avoid 0,1,2,3 ramp feel
  v[(last+1)%10]-=0.05; v[(last+9)%10]-=0.05;
  return normalize(v.map(x=>Math.max(0.01,x)));
}

function sizeTilt(period){
  // size memory (beta(1,1) start)
  const s=JSON.parse(localStorage.getItem('SIZE_MEM')||'[1,1]');
  const tot=s[0]+s[1]; const small=s[0]/tot, big=s[1]/tot;
  const t=Array(10).fill(1);
  for(let i=0;i<5;i++) t[i]*=(0.9+0.2*small);
  for(let i=5;i<10;i++) t[i]*=(0.9+0.2*big);
  return t;
}

/* ---------- predictor ---------- */
function predict(period){
  const base=priorBase(period);
  const anti=priorAntiSequence(period);
  let mix=normalize(base.map((p,i)=>0.82*p+0.18*anti[i]));

  // learning tilt
  const tilt=sizeTilt(period);
  mix=normalize(mix.map((p,i)=>p*tilt[i]));

  // bootstrap + jitter (seeded)
  const rnd=mulberry32(hash32(period));
  const B=72, j=0.09;
  const agg=Array(10).fill(0), votes=Array(10).fill(0);
  for(let b=0;b<B;b++){
    const p=normalize(mix.map(x=>Math.max(0,x*(1+(rnd()*2-1)*j))));
    p.forEach((x,i)=>agg[i]+=x); votes[argmax(p)]++;
  }
  let probs=normalize(agg).map(p=>Math.pow(p,1/1.07)); probs=normalize(probs);

  // cap strongest to keep distribution healthy
  const iM=argmax(probs), cap=0.64;
  if(probs[iM]>cap){
    const excess=probs[iM]-cap; probs[iM]-=excess;
    const rest=probs.reduce((a,b,i)=>i===iM?a:a+b,0)||1;
    const scale=(1-probs[iM])/rest; for(let i=0;i<10;i++) if(i!==iM) probs[i]*=scale;
    probs=normalize(probs);
  }
  const stability=Math.max(...votes)/B;
  return {probs, stability};
}

/* ---------- render ---------- */
function render(period, out, cause='manual'){
  const probs=out.probs; const pick=argmax(probs);
  const size = pick>=5 ? 'Big' : 'Small';

  // confidence
  let H=0; probs.forEach(p=>{ if(p>0) H+=-p*Math.log(p) });
  const entropy=clamp01(1-H/Math.log(10));
  const stability=clamp01(out.stability);
  const score=clamp01(0.55*entropy+0.45*stability);

  el('resultWrap').style.display='grid';
  el('vNum').textContent=pick;
  el('vSize').textContent=size;
  el('confBar').style.width=(score*100).toFixed(0)+'%';

  const issues=[]; if(entropy<0.20) issues.push('low entropy'); if(stability<0.28) issues.push('unstable');
  let signal='Play', cls='ok'; if(issues.length===1){signal='Caution';cls='warn'} if(issues.length>=2){signal='Wait';cls='bad'}
  const ps=el('playSignal'); ps.textContent=signal; ps.className='pill '+cls;

  // history
  const h=el('hist'); if(h.textContent==='‚Äî') h.textContent='';
  h.insertAdjacentHTML('afterbegin',
    `<div class="hrow">‚è± ${new Date().toLocaleTimeString()} ‚Ä¢ tail ${tail4(period)} ‚Üí <b>#${pick}</b> (${size})</div>`);
  [...h.children].slice(14).forEach(n=>n.remove());

  // sound + notify
  el('coinSound').currentTime=0; el('coinSound').play().catch(()=>{});
  if(cause==='auto') pushNotify(tail4(period), pick, size);
}

/* ---------- notifications ---------- */
async function ensureNotify(){ if(!('Notification' in window)) return false;
  if(Notification.permission==='granted') return true;
  if(Notification.permission==='denied') return false;
  try{ return (await Notification.requestPermission())==='granted'; }catch{ return false; }
}
async function pushNotify(tail, digit, size){
  if(await ensureNotify()){
    new Notification(`Next ‚Ä¢ ${tail}`,{
      body:`#${digit} ‚Ä¢ ${size}`, requireInteraction:true
    });
  }
}

/* ---------- actions ---------- */
let timer=null, busy=false;
function setPeriodInfo(p){ el('periodInfo').textContent = isDigits(p)?(`len ${p.length} ‚Ä¢ tail ${tail4(p)}`):'‚Äî'; }

async function run(cause='manual'){
  if(busy) return; busy=true; setTimeout(()=>busy=false,120);
  const p=el('period').value.trim();
  if(!isDigits(p)){ alert('Valid period number ‡§≠‡§∞‡•á‡§Ç (0‚Äì9)'); return; }
  setPeriodInfo(p);
  const out=predict(p);
  render(p,out,cause);
}

function startAuto(){
  const sec=parseInt(el('interval').value,10);
  if(timer){ clearInterval(timer); timer=null; el('btnAuto').textContent='‚ñ∂ Start Auto'; return; }
  ensureNotify();
  el('btnAuto').textContent='‚è∏ Stop Auto';
  timer=setInterval(()=>{
    const cur=el('period').value.trim();
    if(isDigits(cur)) el('period').value=bump(cur);
    run('auto');
  }, sec*1000);
}

/* ---------- bindings ---------- */
document.addEventListener('DOMContentLoaded', ()=>{
  el('btnPredict').addEventListener('click', ()=>run('manual'));
  el('period').addEventListener('keydown', e=>{ if(e.key==='Enter') run('manual'); });
  el('btnAuto').addEventListener('click', startAuto);
  el('notifyBtn').addEventListener('click', ensureNotify);
  el('btnClear').addEventListener('click', ()=>{
    if(timer){clearInterval(timer);timer=null; el('btnAuto').textContent='‚ñ∂ Start Auto';}
    el('period').value=''; setPeriodInfo(''); el('resultWrap').style.display='none'; el('hist').textContent='‚Äî';
  });
  el('btnCopy').addEventListener('click', async()=>{
    const txt=`Period tail ${tail4(el('period').value||'‚Äî')} ‚Ä¢ #${el('vNum').textContent} (${el('vSize').textContent})`;
    try{ await navigator.clipboard.writeText(txt); alert('Copied'); }catch{}
  });
});
</script>
</body>
</html>
