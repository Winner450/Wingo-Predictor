<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>WinGo Predictor Pro — Premium Dashboard</title>
<meta name="theme-color" content="#071018"/>
<meta name="description" content="WinGo Predictor Pro - Premium BDG-like dashboard. Soft / Money Magnet decisions, auto predict (30s/38s/60s), $ processing spinner."/>
<!-- Single-file premium dashboard: HTML + CSS + JS -->
<style>
/* ===================== Root / Reset ===================== */
:root{
  --bg:#061018; --bg-2:#041016;
  --panel:#0d1620; --panel-2:#071018; --panel-3:#041016;
  --text:#e9f6ff; --muted:#93adc3;
  --gold1:#ffeaa3; --gold2:#f6c44b; --gold3:#f0a800;
  --accent-teal:#12dfb8; --accent-cyan:#11a8e6;
  --green:#18c26e; --red:#e95555; --violet:#8b5cf6;
  --outline: rgba(255,255,255,0.06);
  --glass: rgba(255,255,255,0.02);
  --shadow: 0 20px 50px rgba(0,0,0,0.55);
  --r-xl:20px; --r-lg:14px; --r-md:10px;
}
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;padding:0;font-family:Inter, "Segoe UI", system-ui, -apple-system, sans-serif;
  background:
    radial-gradient(900px 500px at 80% -10%, rgba(20,40,60,0.12), transparent 8%),
    linear-gradient(180deg,#051018,#03050a);
  color:var(--text); -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
}
a{color:inherit;text-decoration:none}
.container{max-width:1180px;margin:18px auto;padding:0 14px}

/* ===================== Header (golden pill) ===================== */
.header{
  position:relative;padding:14px 18px;border-radius:999px;text-align:center;font-weight:900;color:#201a06;
  background:linear-gradient(180deg,var(--gold1),var(--gold2) 55%,var(--gold3));
  box-shadow: inset 0 1px 0 rgba(255,255,255,0.5), 0 14px 48px rgba(240,170,40,0.16);
  margin-bottom:18px;
}
.header .shine{position:absolute;inset:0;opacity:.22;pointer-events:none;background:url("https://media.giphy.com/media/l0HlGJcX4zFbhWgW8/giphy.gif") center/cover no-repeat;mix-blend-mode:screen}

/* ===================== Cards / UI ===================== */
.card{
  background: linear-gradient(180deg,var(--panel),var(--panel-2));
  border-radius:var(--r-xl); padding:14px; margin-bottom:14px; border:1px solid var(--outline);
  box-shadow:var(--shadow);
}
.card h3{margin:0 0 10px;font-size:1.02rem;color:#e6f6ff}
.label{color:var(--muted);font-size:.9rem;margin-bottom:8px}
.note{color:#9fbcd8;font-size:.88rem}
.mono{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, monospace}

/* Inputs & Buttons */
.input, .select { width:100%; padding:10px 12px; border-radius:12px; background:#07131a; border:1px solid var(--outline); color:var(--text); outline:none; }
.input::placeholder{color:#7893ad}
.btn{padding:10px 12px;border-radius:12px;border:none;cursor:pointer;font-weight:900}
.btn.primary{background:linear-gradient(180deg,var(--accent-teal),var(--accent-cyan)); color:#031616; box-shadow:0 8px 30px rgba(18,200,170,0.12)}
.btn.ghost{background:transparent;border:1px solid var(--outline);color:var(--text)}
.btn.gold{background:linear-gradient(180deg,var(--gold1),var(--gold2)); color:#241a04}
.btn.warn{background:linear-gradient(180deg,#ffd86b,#f6c44b); color:#2a1700}

/* Check button special */
#btnCheck{min-width:146px;background:linear-gradient(180deg,var(--violet),#5a3fe0);color:#fff;transition:box-shadow .12s,transform .06s,background .12s}
#btnCheck.toggled{ background: linear-gradient(180deg,var(--gold1),var(--gold2)); color:#221700; box-shadow:0 10px 30px rgba(240,170,40,0.18) }

/* Layout helpers */
.row{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
.grid2{display:grid;grid-template-columns:1.4fr .9fr;gap:12px}
@media (max-width:880px){ .grid2{grid-template-columns:1fr} }

/* Tabs */
.tabs{display:grid;grid-template-columns:repeat(4,1fr);gap:10px;margin:10px 0}
.tab-btn{padding:12px;border-radius:12px;background:#07161b;border:1px solid var(--outline);cursor:pointer;font-weight:800}
.tab-btn.active{background:#0b2430;border-color:var(--accent-teal);box-shadow:inset 0 0 0 4px rgba(18,220,180,0.06)}
.tab-pane{display:none}
.tab-pane.active{display:block}

/* Bars */
.bars{display:grid;grid-template-columns:repeat(10,1fr);gap:8px;height:170px;align-items:end;margin:8px 0}
.bar{position:relative;border-radius:10px;background:#071b22;border:1px solid #0f2a36;overflow:hidden}
.bar-fill{position:absolute;left:0;right:0;bottom:0;background:linear-gradient(180deg,#12dfb8,#11a8e6);box-shadow:inset 0 -8px 18px rgba(255,255,255,0.06)}
.bar small{position:absolute;bottom:-18px;width:100%;text-align:center;color:var(--muted)}

/* Prediction row */
.pred-row{display:grid;grid-template-columns:auto 1fr auto;gap:12px;align-items:center;padding:10px;border-radius:12px;background:linear-gradient(180deg,#07161b,#061018);border:1px solid var(--outline);margin-bottom:8px}
.chip{padding:6px 10px;border-radius:999px;font-weight:900;display:inline-flex;align-items:center;gap:8px;background:rgba(255,255,255,0.03)}
.chip.soft{color:#10c48f;background:rgba(16,196,143,0.08);border:1px solid rgba(16,196,143,0.12)}
.chip.money{color:#ffd76b;background:rgba(255,215,107,0.10);border:1px solid rgba(255,215,107,0.12)}

/* Patterns */
.pattern-line{display:flex;flex-wrap:wrap;gap:8px}
.p-pill{padding:6px 10px;border-radius:999px;background:#07121a;border:1px solid var(--outline);font-weight:800}
.p-bg{color:#ffe173} .p-sm{color:#84b8ff}
.p-green{color:#99f1d0} .p-red{color:#ffb4b4}

/* Stats */
.stat-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:12px}
@media (max-width:980px){ .stat-grid{grid-template-columns:repeat(2,1fr)} }
.stat{padding:12px;border-radius:12px;background:#0b1620;border:1px solid var(--outline)}
.stat h4{margin:0;color:#dbeffd}
.stat .v{font-size:1.3rem;font-weight:900;margin-top:6px}
.progress{height:8px;border-radius:999px;background:#07121a;border:1px solid #0d2430;overflow:hidden}
.progress > span{display:block;height:100%;background:linear-gradient(90deg,var(--accent-teal),var(--accent-cyan))}

/* Canvas wrap */
.canvas-wrap{background:#07131a;border-radius:10px;padding:8px;border:1px solid var(--outline)}

/* Processing spinner */
.processing{display:inline-flex;align-items:center;gap:10px;padding:8px 12px;border-radius:999px;background:linear-gradient(180deg,#06121a,#041018);border:1px solid var(--outline)}
.spin{width:42px;height:42px;border-radius:50%;display:grid;place-items:center;background:linear-gradient(180deg,#0f1b23,#071018);position:relative;overflow:hidden;box-shadow:0 8px 30px rgba(0,0,0,0.5)}
.spin .ring{position:absolute;inset:0;border-radius:50%;border:3px solid rgba(255,255,255,0.03);animation:spin 1.05s linear infinite}
.spin .dollar{position:relative;font-weight:900;font-size:18px;color:#ffd86b}
@keyframes spin{from{transform:rotate(0)}to{transform:rotate(360deg)}}

/* Result box */
.result-box{background:linear-gradient(180deg,#07131a,#041018); border-radius:12px; padding:12px; border:1px solid var(--outline)}
.result-row{display:flex;justify-content:space-between;align-items:center;padding:8px 0;border-bottom:1px dashed rgba(255,255,255,0.03)}
.result-row:last-child{border-bottom:0}
.result-key{color:var(--muted);font-weight:700}
.result-val{font-weight:900}

/* Toast */
.toast{position:fixed;left:50%;transform:translateX(-50%);bottom:18px;padding:10px 14px;border-radius:12px;background:#06121a;border:1px solid var(--outline);box-shadow:var(--shadow);z-index:9999}
.hidden{display:none}

/* small tweaks */
.kbd{display:inline-block;border:1px solid var(--outline);border-bottom-width:2px;border-radius:6px;padding:2px 6px;background:#07121a;font-weight:800}
</style>
</head>
<body>
<div class="container">
  <!-- Header -->
  <div class="header">
    <div class="shine"></div>
    <span style="display:inline-block;margin-right:10px;width:12px;height:12px;border-radius:50%;background:#081216;border:2px solid rgba(0,0,0,0.12)"></span>
    <span>WINGO PREDICTOR PRO</span>
  </div>

  <!-- Controls -->
  <div class="card">
    <h3>⚙️ Controls</h3>
    <div class="grid2">
      <div>
        <div class="label">LIVE_API_URL (optional — GitHub raw JSON)</div>
        <input id="apiUrl" class="input mono" placeholder="https://raw.githubusercontent.com/you/repo/branch/history.json"/>
      </div>
      <div style="display:flex;align-items:flex-end;gap:8px">
        <button id="btnConnect" class="btn primary">Connect API</button>
        <button id="btnSample" class="btn ghost">Load Sample</button>
      </div>
    </div>

    <div style="margin-top:12px" class="row">
      <div style="flex:1 1 300px">
        <div class="label">Strategy</div>
        <select id="strategy" class="select">
          <option value="balanced" selected>Balanced (High ≥ 0.75)</option>
          <option value="conservative">Conservative (High ≥ 0.82)</option>
          <option value="aggressive">Aggressive (High ≥ 0.68)</option>
          <option value="custom">Custom…</option>
        </select>
      </div>
      <div style="flex:1 1 180px">
        <div class="label">High Threshold (0.50–0.95)</div>
        <input id="thHigh" type="number" class="input" min="0.5" max="0.95" step="0.01" value="0.75"/>
      </div>
      <div style="flex:1 1 160px">
        <div class="label">Auto Predict Interval</div>
        <select id="autoInterval" class="select">
          <option value="0" selected>Off</option>
          <option value="30">30s</option>
          <option value="38">38s</option>
          <option value="60">60s</option>
        </select>
      </div>
      <div style="flex:0 0 120px;align-self:flex-end">
        <button id="btnApply" class="btn primary" style="width:100%">Apply</button>
      </div>
      <div class="pill" style="align-self:flex-end;padding:8px 12px;gap:8px">
        Live: <strong id="liveState">Off</strong>
      </div>
    </div>

    <div class="note" style="margin-top:8px">
      Tip: यदि आप GitHub raw JSON देंगे तो history वहाँ से आएगा और predictions historical data-aware होंगे।
    </div>
  </div>

  <!-- Check by Period -->
  <div class="card">
    <h3>🔎 Check by Period</h3>
    <div class="row">
      <input id="periodInput" class="input mono" placeholder="Enter Period number (e.g. 20250814100051634 or 51653)"/>
      <button id="btnCheck" class="btn">Check</button>
    </div>
    <div id="periodError" class="note" style="color:var(--red);margin-top:8px;display:none"></div>

    <div style="margin-top:12px" class="grid2">
      <div class="card" style="margin:0">
        <h3>Result</h3>
        <div class="result-box">
          <div class="result-row"><div class="result-key">Input</div><div class="result-val mono" id="res-input">—</div></div>
          <div class="result-row"><div class="result-key">Using period</div><div class="result-val mono" id="res-period">—</div></div>
          <div class="result-row"><div class="result-key">Digit</div><div class="result-val mono" id="res-digit">—</div></div>
          <div class="result-row"><div class="result-key">Type</div><div class="result-val mono" id="res-type">—</div></div>
          <div class="result-row"><div class="result-key">Color</div><div class="result-val mono" id="res-color">—</div></div>
          <div class="result-row"><div class="result-key">Confidence</div><div class="result-val mono" id="res-conf">—</div></div>
          <div class="result-row"><div class="result-key">Decision</div><div class="result-val" id="res-decision"><span class="chip">—</span></div></div>
        </div>
      </div>

      <div class="card" style="margin:0">
        <h3>About</h3>
        <div class="note">
          • Period → deterministic hash → <b>digit (0–9)</b>.<br/>
          • digit ≥5 ⇒ <b>Big</b>, else <b>Small</b>.<br/>
          • Color parity uses hash bits so similar periods change output.<br/>
          • Confidence uses history-aware math: frequency + recency + entropy + shrinkage.<br/>
          • Decisions ONLY: <span class="chip soft">Soft 💚</span> or <span class="chip money">Money Magnet 🧲</span>.
        </div>
      </div>
    </div>
  </div>

  <!-- Tabs -->
  <div class="tabs">
    <div class="tab-btn active" data-tab="tab-prob">Probability</div>
    <div class="tab-btn" data-tab="tab-preds">Predictions</div>
    <div class="tab-btn" data-tab="tab-patterns">Patterns</div>
    <div class="tab-btn" data-tab="tab-stats">Stats</div>
  </div>

  <!-- Probability -->
  <div id="tab-prob" class="tab-pane active">
    <div class="card">
      <h3>📊 Probability (0–9) <span class="note" id="probSource">(from history)</span></h3>
      <div class="bars" id="probBars"></div>
      <div class="row" style="justify-content:space-between;margin-top:8px">
        <div class="note">Top: <span id="probTop" class="mono">—</span></div>
        <div class="note">Bottom: <span id="probBottom" class="mono">—</span></div>
      </div>
      <div style="margin-top:12px" class="canvas-wrap"><canvas id="probCanvas" height="150" style="width:100%"></canvas></div>
      <div class="note" style="margin-top:8px">Bar heights are smoothed using history and shrinkage to avoid overfitting.</div>
    </div>
  </div>

  <!-- Predictions -->
  <div id="tab-preds" class="tab-pane">
    <div class="card"><h3>🕒 Recent Predictions</h3><div id="predList"></div></div>
  </div>

  <!-- Patterns -->
  <div id="tab-patterns" class="tab-pane">
    <div class="card"><h3>🧩 Big/Small Pattern</h3><div id="patBS" class="pattern-line"></div></div>
    <div class="card"><h3>🟢🔴 Color Pattern</h3><div id="patCR" class="pattern-line"></div></div>
    <div class="row">
      <div class="card" style="flex:1"><h3>🔥 Hot Numbers</h3><div id="hotList" class="pattern-line"></div></div>
      <div class="card" style="flex:1"><h3>❄️ Cold Numbers</h3><div id="coldList" class="pattern-line"></div></div>
    </div>
    <div class="card"><h3>📍 Gap Heatmap (Last 40)</h3><div id="gapMap" class="pattern-line"></div></div>
  </div>

  <!-- Stats -->
  <div id="tab-stats" class="tab-pane">
    <div class="card">
      <h3>📈 Stats Overview</h3>
      <div class="stat-grid">
        <div class="stat"><h4>Total Records</h4><div class="v mono" id="st-total">—</div></div>
        <div class="stat"><h4>Money Magnet Rate</h4><div class="v mono" id="st-mm">—</div><div class="progress"><span id="st-mm-p" style="width:0%"></span></div></div>
        <div class="stat"><h4>Avg Confidence</h4><div class="v mono" id="st-avg">—</div><div class="progress"><span id="st-avg-p" style="width:0%"></span></div></div>
        <div class="stat"><h4>Top Digit (Hit%)</h4><div class="v mono" id="st-top">—</div></div>
      </div>
    </div>
    <div class="card"><h3>📊 Distribution</h3><div class="canvas-wrap"><canvas id="distCanvas" height="160" style="width:100%"></canvas></div></div>
  </div>

  <div style="height:36px"></div>
</div>

<!-- Toast -->
<div id="toast" class="toast hidden"><div id="toastText">Loaded</div></div>

<script>
/* ======================= Utilities ======================= */
const $ = s => document.querySelector(s);
const $$ = s => Array.from(document.querySelectorAll(s));
const clamp = (v,min,max) => Math.max(min, Math.min(max, v));
const toast = (m,ms=1400)=>{ const t=$("#toast"); $("#toastText").textContent=m; t.classList.remove("hidden"); clearTimeout(toast._t); toast._t=setTimeout(()=>t.classList.add("hidden"),ms); };

/* ======================= Stable Hash (FNV-1a like) ======================= */
function fnv1a(str){
  let h = 0x811c9dc5 >>> 0;
  for(let i=0;i<str.length;i++){
    h ^= str.charCodeAt(i);
    h = Math.imul(h ^ (h >>> 16), 0x45d9f3b) >>> 0;
    h = (h + ((h<<3)>>>0) + ((h<<7)>>>0)) >>> 0;
  }
  return h >>> 0;
}
function periodDigit(period){ return fnv1a(String(period)) % 10; }
function digitColor(d,period){ const h = fnv1a(String(period)); const parity = ((h>>>3) ^ (h>>>7) ^ (h>>>11)) & 1; return ((d%2)^parity) ? "Red" : "Green"; }

/* ======================= Confidence calculation (improved) ======================= */
function baseConf(d,period){
  const h = fnv1a(String(period)+'#'+d);
  return 0.62 + ((h & 1023)/1023)*0.28; // 0.62..0.90
}
function computeConfidence(d,period,history){
  const base = baseConf(d,period);
  let freq = 0; for(let i=0;i<history.length;i++) if(history[i].num===d) freq++;
  const total = Math.max(1, history.length); const rate = freq/total;
  let freqAdj=0;
  if(rate < 0.06) freqAdj = 0.06;
  else if(rate < 0.12) freqAdj = 0.03;
  else if(rate > 0.25) freqAdj = -0.04;
  const lastIdx = history.findIndex(h=>h.num===d);
  let recPenalty = 0;
  if(lastIdx !== -1){
    if(lastIdx <= 2) recPenalty = 0.06;
    else if(lastIdx <= 6) recPenalty = 0.03;
  }
  const hv = (fnv1a(String(period)+'v') & 255)/255;
  const entropyAdj = (hv - 0.5) * 0.06;
  let raw = base + freqAdj - recPenalty + entropyAdj;
  const prior = 0.72; const N = Math.min(60, total); const k=7; const alpha = N/(N+k);
  const final = alpha*raw + (1-alpha)*prior;
  return clamp(final, 0.50, 0.95);
}

/* ======================= strategies ======================= */
const strategies = { balanced:{high:0.75}, conservative:{high:0.82}, aggressive:{high:0.68}, custom:{high:0.75} };

/* ======================= App State ======================= */
const state = {
  apiUrl: "",
  history: [],
  probs: new Array(10).fill(0),
  high: strategies.balanced.high,
  autoTimer: null,
  autoSec: 0
};

/* ======================= normalize history ======================= */
function normalizeHistory(arr){
  const out = [];
  (arr || []).forEach((r,i)=>{
    const period = r.period ?? (1000 + i);
    const num = Number.isInteger(r.num) ? clamp(r.num,0,9) : periodDigit(period);
    const type = r.type ?? (num>=5?"Big":"Small");
    const color = r.color ?? digitColor(num,period);
    const conf = (typeof r.confidence === "number") ? clamp(r.confidence,0.5,0.95) : computeConfidence(num,period,out);
    const ts = r.ts ?? (Date.now() - i*60000);
    out.push({period, num, type, color, confidence: conf, ts});
  });
  return out;
}

/* ======================= API fetch helper ======================= */
async function fetchApi(url){
  const res = await fetch(url, { cache: "no-store" });
  if(!res.ok) throw new Error(res.status + " " + res.statusText);
  return await res.json();
}

/* ======================= Bind Controls ======================= */
function bindControls(){
  $("#btnSample").addEventListener("click", loadSample);
  $("#btnConnect").addEventListener("click", async ()=>{
    const url = $("#apiUrl").value.trim(); if(!url){ toast("Paste LIVE_API_URL"); return; }
    try{
      toast("Fetching API...");
      const json = await fetchApi(url);
      state.history = normalizeHistory(json.history || json || []);
      renderAll();
      $("#probSource").textContent = "(from API)";
      toast("API connected ✓");
    }catch(e){ console.error(e); toast("API load failed"); }
  });

  $("#btnApply").addEventListener("click", ()=>{
    const strat = $("#strategy").value; state.high = parseFloat($("#thHigh").value) || strategies[strat].high;
    const sec = parseInt($("#autoInterval").value,10) || 0;
    setAuto(sec);
    renderLiveBadge();
    toast("Settings applied ✓");
  });

  // Check button toggle & run check
  $("#btnCheck").addEventListener("click", async ()=>{
    const btn = $("#btnCheck");
    btn.classList.add("toggled");
    setTimeout(()=>btn.classList.remove("toggled"), 250);
    const p = $("#periodInput").value.trim();
    if(!p){ $("#periodError").style.display="block"; $("#periodError").textContent="Please enter a period number."; return; }
    $("#periodError").style.display="none";
    // show 3s processing
    await showProcessing(3000);
    const out = checkByPeriod(p);
    // push to history (newest-first)
    state.history.unshift({period: out.period, num: out.digit, type: out.type, color: out.color, confidence: out.conf, ts: Date.now()});
    if(state.history.length > 800) state.history = state.history.slice(0,800);
    renderAll(); renderCheck(out);
  });

  // Tabs
  $$(".tab-btn").fo
