<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>üéØ WinGo Predictor Pro</title>
<link rel="preconnect" href="https://cdn.jsdelivr.net">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
:root{
  --gold:#ffd54a; --gold2:#f6c028; --ink:#e8eef9; --muted:#9aa7bd;
  --bg:#0b1019; --glass:#111827; --stroke:#1e2637;
  --ok:#22c55e; --warn:#f59e0b; --bad:#ef4444;
  --radius:16px; --shadow:0 16px 34px rgba(0,0,0,.35);
}
*{box-sizing:border-box} body{margin:0;background:radial-gradient(1200px 700px at 20% -10%,#0d1627 0%,#080c14 38%,#070a12 100%);color:#fff;font:15.5px/1.45 ui-sans-serif,system-ui,Segoe UI,Roboto}

/* GOLDEN HEADER */
.topbar-wrap{position:sticky;top:0;z-index:50;background:linear-gradient(180deg,#0a0f19,#070b12);border-bottom:1px solid #0f1421}
.topbar{max-width:1100px;margin:0 auto;padding:12px 14px;display:flex;align-items:center;justify-content:space-between}
.brand-pill{display:inline-flex;gap:10px;align-items:center;background:linear-gradient(180deg,var(--gold),var(--gold2));color:#111;font-weight:900;border-radius:999px;padding:10px 18px;box-shadow:0 6px 16px rgba(255,213,74,.25)}
.brand-dot{width:12px;height:12px;border-radius:50%;background:#0c0f18;box-shadow:inset 0 0 0 2px rgba(0,0,0,.25)}
.brand-text{letter-spacing:.4px}
.compact-toggle{color:#d8e0f0;font-size:13px;display:flex;gap:8px;align-items:center}

/* CONTAINER + CARDS */
.container{max-width:1100px;margin:16px auto;padding:0 14px 70px}
.card{background:linear-gradient(180deg,#0e1523,#0b1220);border:1px solid rgba(255,255,255,.06);border-radius:var(--radius);box-shadow:var(--shadow);padding:16px}
.h1{font-size:19px;font-weight:800;margin:0 0 10px}
.sub{color:var(--muted);font-size:13px;margin-top:6px}

/* FORM */
.grid{display:grid;grid-template-columns:1.1fr .9fr;gap:14px}
@media (max-width:900px){.grid{grid-template-columns:1fr}}
label{font-size:13px;color:#cbd7ee;font-weight:800;margin-bottom:6px;display:block}
input,select{width:100%;padding:14px;background:#0f1728;border:2px solid #1e2740;border-radius:12px;color:#fff;font-size:16px;outline:none}
input:focus,select:focus{border-color:var(--gold)}
.row{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
.pill{display:inline-flex;align-items:center;gap:10px;background:#10182a;border:1px solid #1e2740;border-radius:18px;padding:10px 14px;color:#d6def2}
.btn{background:linear-gradient(180deg,var(--gold),var(--gold2));color:#161616;font-weight:900;border:0;border-radius:12px;padding:12px 18px;cursor:pointer}
.btn.sec{background:#10182a;color:#e6ecfb;border:1px solid #24304a}
.kv{display:grid;grid-template-columns:repeat(3,1fr);gap:12px}
@media (max-width:900px){.kv{grid-template-columns:1fr}}
.box{background:#0d1526;border:1px solid #1b2440;border-radius:14px;padding:14px}
.key{color:#9fb1d8;font-size:12px}
.val{color:var(--gold);font-weight:900;font-size:32px}
.line{height:12px;background:#172037;border-radius:999px;overflow:hidden;margin:10px 0 2px}
.bar{height:12px;width:0%;background:linear-gradient(90deg,var(--gold2),var(--gold))}
.sig{display:inline-flex;border-radius:999px;border:1px solid #283557;padding:6px 10px;font-weight:900}
.ok{color:var(--ok)} .warn{color:var(--warn)} .bad{color:var(--bad)}
.grid2{display:grid;grid-template-columns:1fr 1fr;gap:14px}
@media (max-width:900px){.grid2{grid-template-columns:1fr}}
.history{font-size:12px;color:#d2dcf6;max-height:240px;overflow:auto}
.hrow{padding:7px 0;border-bottom:1px dashed #213053}
.helper{font-size:12px;color:#9fb1d8}
.hr{height:1px;background:#16213a;margin:12px 0}

/* VERIFY & LEARN */
.verify{display:grid;grid-template-columns:1fr 1fr;gap:12px;align-items:center}
.verify .center{display:flex;justify-content:center}
.win{color:var(--ok);font-weight:900}
.lose{color:var(--bad);font-weight:900}

/* FOOT CHIPS */
.chips{display:flex;gap:8px;flex-wrap:wrap}
.chip{font-weight:800;border:1px solid #2b3a5f;border-radius:999px;padding:6px 10px;color:#cfe2ff}

/* Compact toggle (demo only) */
.hide{display:none}
</style>
</head>
<body>
<!-- HEADER -->
<div class="topbar-wrap">
  <div class="topbar">
    <div class="brand-pill">
      <span class="brand-dot"></span>
      <span class="brand-text">WINGO PREDICTOR PRO</span>
    </div>
    <label class="compact-toggle">
      <input id="compactToggle" type="checkbox" />
      <span>Compact</span>
    </label>
  </div>
</div>

<div class="container">
  <!-- CONTROL -->
  <div class="card">
    <div class="h1">Quick Predict</div>
    <div class="grid">
      <div>
        <label for="period">üßæ Period Number</label>
        <input id="period" placeholder="‡§ï‡•á‡§µ‡§≤ digits (0‚Äì9) ‚Ä¢ tail ‡§ñ‡•Å‡§¶-‡§¨-‡§ñ‡•Å‡§¶ ‡§¶‡§ø‡§ñ‡•á‡§ó‡§æ" />
        <div class="sub" id="periodInfo">‚Äî</div>
      </div>
      <div>
        <label for="mode">Strategy</label>
        <select id="mode">
          <option value="high" selected>High-Trade</option>
          <option value="risk">Risk-Controlled</option>
          <option value="aggressive">Aggressive</option>
          <option value="conservative">Conservative</option>
          <option value="normal">Normal</option>
        </select>

        <div class="row" style="margin-top:8px">
          <label class="pill"><input id="autoNext" type="checkbox" /> <b>Auto Next</b></label>
          <label class="pill">Interval
            <select id="interval" style="width:120px">
              <option value="30">30 sec</option>
              <option value="60">60 sec</option>
            </select>
          </label>
          <label class="pill">Max Skip
            <select id="maxSkip" style="width:90px">
              <option value="0">0</option>
              <option value="1">1</option>
              <option value="2">2</option>
              <option value="3" selected>3</option>
              <option value="4">4</option>
              <option value="5">5</option>
            </select>
          </label>
        </div>

        <div class="row" style="margin-top:8px">
          <label class="pill"><input id="antiSeq" type="checkbox" checked /> Anti-sequence</label>
          <label class="pill"><input id="learnOn" type="checkbox" checked /> Learning ON</label>
          <label class="pill"><input id="soundOn" type="checkbox" checked /> Sound ON</label>
          <button class="btn sec" id="notifyBtn">üîî Notifications</button>
        </div>
      </div>
    </div>

    <div class="row" style="margin-top:12px">
      <button class="btn" id="btnPredict">üîÆ Predict</button>
      <button class="btn sec" id="btnClear">Clear</button>
      <button class="btn sec" id="btnCopy">Copy Result</button>
      <span class="helper" id="why">‚Äî</span>
    </div>

    <div class="hr"></div>

    <!-- Patterns -->
    <div class="row">
      <label class="pill"><input id="pReverse" type="checkbox" checked /> Reverse</label>
      <label class="pill"><input id="pMirror" type="checkbox" checked /> Mirror</label>
      <label class="pill"><input id="pCont" type="checkbox" checked /> Continuous</label>
      <label class="pill"><input id="pGap" type="checkbox" checked /> Gap/Skip</label>
      <label class="pill"><input id="pStreak" type="checkbox" checked /> Streak-Guard</label>
    </div>
  </div>

  <!-- RESULT -->
  <div class="card" id="resultCard" style="margin-top:14px;display:none">
    <div class="kv">
      <div class="box"><div class="key">üßæ Period</div><div class="val" id="vPeriod">‚Äî</div></div>
      <div class="box"><div class="key">üî¢ Predicted Number</div><div class="val" id="vNum">‚Äî</div></div>
      <div class="box"><div class="key">üìè Size</div><div class="val" id="vSize">‚Äî</div></div>
    </div>
    <div style="margin-top:10px">
      <div class="key">üß† Confidence</div>
      <div class="line"><div class="bar" id="confBar"></div></div>
    </div>
    <div style="margin-top:10px" class="chips">
      <span id="signal" class="sig">‚Äî</span>
      <span id="scoreChip" class="chip">‚Äî</span>
      <span id="patternChip" class="chip">‚Äî</span>
    </div>
  </div>

  <!-- VERIFY & LEARN -->
  <div class="card" style="margin-top:14px">
    <div class="h1">Verify & Learn</div>
    <div class="verify">
      <div>
        <label class="pill"><input type="radio" name="actSize" id="actSmall" value="small" /> Small (0‚Äì4)</label>
      </div>
      <div class="center">
        <button class="btn sec" id="btnVerify">Verify & Learn</button>
      </div>
      <div>
        <label class="pill"><input type="radio" name="actSize" id="actBig" value="big" /> Big (5‚Äì9)</label>
      </div>
    </div>
    <div class="helper" id="verifyMsg" style="margin-top:8px">‚Äî</div>
  </div>

  <!-- CHARTS + HISTORY -->
  <div class="grid2" style="margin-top:14px">
    <div class="card">
      <div class="h1">üìä Probability (0‚Äì9)</div>
      <canvas id="probChart" height="220"></canvas>
    </div>
    <div class="card">
      <div class="h1">üïò Recent Predictions</div>
      <div id="hist" class="history">‚Äî</div>
    </div>
  </div>
</div>

<script>
/* ------------ UTILITIES ------------ */
const el=id=>document.getElementById(id);
const isDigits=s=>/^\d+$/.test(s||"");
const clamp01=x=>Math.max(0,Math.min(1,x));
const normalize=a=>{const s=a.reduce((p,c)=>p+c,0)||1;return a.map(x=>x/s);};
const argmax=a=>a.indexOf(Math.max(...a));
function bump(p){ try{ return (BigInt(p)+1n).toString(); }catch{ const a=p.split('').map(n=>+n); for(let i=a.length-1;i>=0;i--){ if(a[i]===9) a[i]=0; else{a[i]++;break;} } return a.join(''); } }
function hash32(str){let h=2166136261>>>0;for(let i=0;i<str.length;i++){h^=str.charCodeAt(i);h=Math.imul(h,16777619)}return h>>>0;}
function mulberry32(seed){return function(){let t=seed+=0x6D2B79F5;t=Math.imul(t^t>>>15,t|1);t^=t+Math.imul(t^t>>>7,t|61);return((t^t>>>14)>>>0)/4294967296}}

/* ------------ SOUND (coin ping ~1s) ------------ */
let pingCtx=null;
function coinPing(){
  if(!el('soundOn').checked) return;
  try{
    if(!pingCtx) pingCtx=new (window.AudioContext||window.webkitAudioContext)();
    const o=pingCtx.createOscillator(), g=pingCtx.createGain();
    o.type='triangle'; o.frequency.value=880;  // A5
    g.gain.value=0.15;
    o.connect(g); g.connect(pingCtx.destination);
    o.start();
    setTimeout(()=>{o.stop();}, 120);
    setTimeout(()=>{const o2=pingCtx.createOscillator(), g2=pingCtx.createGain(); o2.type='sine'; o2.frequency.value=1568; g2.gain.value=0.12; o2.connect(g2); g2.connect(pingCtx.destination); o2.start(); setTimeout(()=>o2.stop(),140);},140);
  }catch{}
}

/* ------------ NOTIFY ------------ */
async function ensureNotifyPerm(){
  if(!('Notification' in window)) return false;
  if(Notification.permission==='granted') return true;
  if(Notification.permission==='denied') return false;
  try{ return (await Notification.requestPermission())==='granted'; }catch{ return false; }
}
async function notify({tail,digit,size,sig,conf}){
  try{
    if(!(await ensureNotifyPerm())) return;
    const body = `${sig} ‚Ä¢ #${digit} ‚Ä¢ ${size} ‚Ä¢ ${(conf*100).toFixed(0)}%`;
    new Notification(`Next ‚Ä¢ ${tail}`,{ body, renotify:true, tag:`wingo-${tail}` });
  }catch{}
}

/* ------------ LEARNING (size only) ------------ */
const LS_SIZE='WPP_SIZE2';
const loadSize =()=>{ try{ return JSON.parse(localStorage.getItem(LS_SIZE))||[1,1]; }catch{ return [1,1]; } };
const saveSize =s=>localStorage.setItem(LS_SIZE,JSON.stringify(s));

/* ------------ PRIORS + PATTERNS ------------ */
// base priors (deliberately NOT last-digit)
function prior_checksum(period){
  if(!isDigits(period)) return Array(10).fill(0.1);
  const s=[...period].reduce((a,b)=>a+(+b),0), t=(s%9+s%10)%10;
  const v=Array(10).fill(0.1); v[t]+=0.30; v[(t+1)%10]+=0.16; v[(t+9)%10]+=0.16; return normalize(v);
}
function prior_cycle(period){
  if(!isDigits(period)) return Array(10).fill(0.1);
  const d=[...period].map(Number), s=d.reduce((a,b)=>a+b,0), mod7=s%7;
  const v=Array(10).fill(0.1); v[(mod7*3)%10]+=0.22; v[(mod7*5)%10]+=0.20; return normalize(v);
}
function prior_parity(period){
  if(!isDigits(period)) return Array(10).fill(0.1);
  const even=(+period.slice(-2))%2===0; const v=Array(10).fill(0.1);
  if(even){for(let i=0;i<10;i+=2)v[i]+=0.22}else{for(let i=1;i<10;i+=2)v[i]+=0.22}
  return normalize(v);
}
function prior_hashed(period){ // distance from a hashed seed digit (not last digit)
  if(!isDigits(period)) return Array(10).fill(0.1);
  const seedDigit = hash32(period+'d')%10; const v=Array(10).fill(0.1);
  for(let i=0;i<10;i++){const d=Math.min((i-seedDigit+10)%10,(seedDigit-i+10)%10); v[i]+=0.28*Math.exp(-0.55*d);}
  return normalize(v);
}
function prior_bucket(period, antiSeq){
  if(!isDigits(period)) return Array(10).fill(0.1);
  const tail=+period.slice(-3), m=tail%10, v=Array(10).fill(0.1);
  const k=antiSeq?0.16:0.36; v[m]+=k; v[(m+3)%10]+=k*0.55; v[(m+7)%10]+=k*0.45;
  return normalize(v);
}

/* pattern transforms */
function pat_mirror(prob){
  // tilt towards digits mirrored around 5 (0<->9,1<->8,...)
  const map=[9,8,7,6,5,4,3,2,1,0]; const out=prob.slice();
  for(let i=0;i<10;i++) out[i]=(out[i]*0.85 + prob[map[i]]*0.15);
  return normalize(out);
}
function pat_reverse(prob){
  // favour descending vs ascending chunk
  const out=prob.slice();
  for(let i=1;i<10;i++) out[i]*=(1+0.01*i);
  return normalize(out);
}
function pat_continuous(prob){
  // emphasize top-2 further
  const s=prob.slice().sort((a,b)=>b-a), t=s[1];
  return normalize(prob.map(p=>p*(1+0.25*Math.max(0,(p-t)/(t+1e-9)))));
}
function pat_gap(prob){
  // smooth small gaps; penalize extremes a bit
  const m=prob.reduce((a,b)=>a+b,0)/10;
  return normalize(prob.map(p=>p*0.9 + m*0.1));
}
function pat_streak(prob){
  // reduce over-confidence to avoid long wrong streaks
  const mx=Math.max(...prob); if(mx>0.28){ const i=argmax(prob); prob[i]-=0.03; }
  return normalize(prob);
}

/* strategy weights */
function strategy(mode){
  switch(mode){
    case 'risk':         return {temp:1.02, cap:0.56, jitter:0.05, adapt:0.10, learn:0.28, w:[0.22,0.18,0.18,0.18,0.10,0.06,0.08], minConf:0.50};
    case 'high':         return {temp:1.12, cap:0.70, jitter:0.14, adapt:0.28, learn:0.32, w:[0.16,0.14,0.12,0.22,0.16,0.10,0.10], minConf:0.40};
    case 'conservative': return {temp:1.04, cap:0.60, jitter:0.06, adapt:0.14, learn:0.26, w:[0.22,0.18,0.18,0.18,0.12,0.06,0.06], minConf:0.48};
    case 'aggressive':   return {temp:1.08, cap:0.66, jitter:0.10, adapt:0.20, learn:0.30, w:[0.20,0.16,0.16,0.20,0.14,0.08,0.06], minConf:0.44};
    default:             return {temp:1.06, cap:0.62, jitter:0.08, adapt:0.18, learn:0.30, w:[0.20,0.18,0.18,0.18,0.12,0.06,0.08], minConf:0.46};
  }
}

/* adaptive decision: reduce min after skips, force soft play on maxSkip */
let skipStreak=0;
function decideSig(conf, baseMin, mode){
  const maxSkip = parseInt(el('maxSkip').value||'3',10);
  let min = baseMin;
  if(mode==='high'){
    min -= Math.min(0.06, skipStreak*0.02);
  }else{
    min -= Math.min(0.03, skipStreak*0.01);
  }
  let sig='Skip';
  if(conf >= (min+0.06)) sig='Play';
  else if(conf >= (min*0.92)) sig='Soft Play';
  if(sig==='Skip' && skipStreak>=maxSkip && conf >= (min*0.85)) sig='Soft Play';
  return {sig, usedMin:min};
}

/* ------------ CORE PREDICTOR ------------ */
function predictLocal(period){
  const mode=el('mode').value;
  const S=strategy(mode);
  const P1=prior_checksum(period), P2=prior_cycle(period), P3=prior_parity(period),
        P4=prior_hashed(period), P7=prior_bucket(period, el('antiSeq').checked);

  // weights: [checksum, cycle, parity, hashed, mirror, reversal, bucket]
  let base=normalize(P1.map((_,i)=> S.w[0]*P1[i] + S.w[1]*P2[i] + S.w[2]*P3[i] + S.w[3]*P4[i] + S.w[6]*P7[i]));

  // adapt expand top tail
  const sorted=base.slice().sort((a,b)=>b-a), t=sorted[2]||0.1;
  base=normalize(base.map(p=>p*(1+S.adapt*((p-t)/(t+1e-9)))));

  // size learning tilt
  if(el('learnOn').checked){
    const sz=loadSize(); const total=(sz[0]+sz[1])||1;
    const small=sz[0]/total, big=sz[1]/total;
    for(let i=0;i<5;i++)  base[i]*=(1 - S.learn + S.learn*small);
    for(let i=5;i<10;i++) base[i]*=(1 - S.learn + S.learn*big);
    base=normalize(base);
  }

  // patterns
  if(el('pMirror').checked) base=pat_mirror(base);
  if(el('pReverse').checked) base=pat_reverse(base);
  if(el('pCont').checked) base=pat_continuous(base);
  if(el('pGap').checked) base=pat_gap(base);
  if(el('pStreak').checked) base=pat_streak(base);

  // bootstrap + jitter
  const seed=hash32(period); const rnd=mulberry32(seed);
  const B=72,j=S.jitter; const agg=Array(10).fill(0), votes=Array(10).fill(0);
  for(let b=0;b<B;b++){ const p=normalize(base.map(x=>Math.max(0,x*(1+(rnd()*2-1)*j)))); p.forEach((x,i)=>agg[i]+=x); votes[argmax(p)]++; }
  let probs=normalize(agg).map(p=>Math.pow(p,1/S.temp)); probs=normalize(probs);
  const iM=argmax(probs), mx=probs[iM];
  if(mx>S.cap){ const excess=mx-S.cap; probs[iM]-=excess; const rest=probs.reduce((a,b,i)=>i===iM?a:a+b,0)||1; const scale=(1-probs[iM])/rest; for(let i=0;i<10;i++) if(i!==iM) probs[i]*=scale; probs=normalize(probs); }

  // confidence ‚âà max prob
  const conf = Math.max(...probs);
  return {probs, pick:iM, conf, minConf:S.minConf, mode};
}

/* ------------ CHART ------------ */
let probChart=null;
function renderChart(probs){
  const data=probs.map(p=>Math.round(p*1000)/10), labels=[...Array(10).keys()].map(String);
  if(probChart) probChart.destroy();
  probChart=new Chart(el('probChart').getContext('2d'),{
    type:'bar',
    data:{labels,datasets:[{label:'Probability (%)',data}]},
    options:{responsive:true,scales:{y:{beginAtZero:true,title:{display:true,text:'%'}},x:{title:{display:true,text:'Digit'}}}}
  });
}

/* ------------ RENDER ------------ */
function describePeriod(p){return isDigits(p)?`len ${p.length} ‚Ä¢ tail ${p.slice(-4)}`:'‚Äî';}

function render(period,out,source){
  // UI
  el('resultCard').style.display='block';
  el('vPeriod').textContent=period;
  el('vNum').textContent=out.pick;
  el('vSize').textContent=(out.pick>=5)?'Big':'Small';
  el('confBar').style.width=(out.conf*100).toFixed(1)+'%';
  renderChart(out.probs);

  // decision
  const dec = decideSig(out.conf, out.minConf, out.mode);
  const sig = dec.sig;
  const cls = (sig==='Play') ? 'ok' : (sig==='Soft Play' ? 'warn' : 'bad');
  el('signal').className='sig '+cls;
  el('signal').textContent=sig;
  el('why').textContent = `Conf ${(out.conf*100).toFixed(0)}% ‚Ä¢ min ${(dec.usedMin*100).toFixed(0)}%`;

  // streak accounting
  if(sig==='Skip') skipStreak++; else skipStreak=0;

  el('patternChip').textContent = `Mode ${out.mode}`;
  el('scoreChip').textContent = `Pick #${out.pick}`;

  // history
  const h=el('hist'); if(h.textContent==='‚Äî') h.textContent='';
  h.insertAdjacentHTML('afterbegin',
    `<div class="hrow">‚è± ${new Date().toLocaleTimeString()} ‚Ä¢ tail ${String(period).slice(-4)} ‚Üí #${out.pick} (${out.pick>=5?'Big':'Small'}) ‚Ä¢ ${sig}</div>`
  );
  [...h.children].slice(18).forEach(n=>n.remove());

  // notify + sound (only on auto/predict, not on clear)
  if(source!=='clear'){
    if(sig!=='Skip') coinPing();
    notify({tail:String(period).slice(-3),digit:out.pick,size:(out.pick>=5?'Big':'Small'),sig,conf:out.conf});
  }
}

/* ------------ ACTIONS ------------ */
let timer=null, busy=false;

async function doPredict(source='manual'){
  if(busy) return; busy=true; setTimeout(()=>busy=false,120);
  const pr=el('period').value.trim(); if(!isDigits(pr)){alert('Valid period number ‡§≠‡§∞‡•á‡§Ç');return;}
  el('periodInfo').textContent='Period: '+describePeriod(pr);
  const out=predictLocal(pr);
  render(pr,out,source);
}

function startAuto(){
  const sec=parseInt(el('interval').value||'30',10);
  clearInterval(timer); timer=setInterval(()=>{
    const cur=el('period').value.trim(); if(isDigits(cur)) el('period').value=bump(cur);
    doPredict('auto');
  }, sec*1000);
}

document.addEventListener('DOMContentLoaded', ()=>{
  // buttons
  el('btnPredict').addEventListener('click', ()=>doPredict('manual'));
  el('period').addEventListener('keydown', e=>{ if(e.key==='Enter') doPredict('manual'); });
  el('btnClear').addEventListener('click', ()=>{
    clearInterval(timer); timer=null; el('autoNext').checked=false;
    el('periodInfo').textContent='‚Äî'; el('resultCard').style.display='none';
    el('hist').textContent='‚Äî'; skipStreak=0; renderChart(Array(10).fill(0.1));
  });
  el('btnCopy').addEventListener('click', async ()=>{
    const txt=`Period: ${el('vPeriod').textContent}, Number: ${el('vNum').textContent}, Size: ${el('vSize').textContent}, ${el('signal').textContent}`;
    try{ await navigator.clipboard.writeText(txt); alert('Copied!'); }catch{}
  });

  // auto
  el('autoNext').addEventListener('change', e=>{
    clearInterval(timer); timer=null; if(e.target.checked) startAuto();
  });
  el('interval').addEventListener('change', ()=>{ if(el('autoNext').checked){ startAuto(); } });

  // notifications
  el('notifyBtn').addEventListener('click', async ()=> alert((await ensureNotifyPerm())?'Notifications enabled':'Notifications blocked'));

  // verify & learn
  el('btnVerify').addEventListener('click', ()=>{
    const pick = el('vNum').textContent.trim();
    if(!pick || pick==='‚Äî'){ el('verifyMsg').textContent='‡§™‡§π‡§≤‡•á Predict ‡§ï‡§∞‡•á‡§Ç.'; el('verifyMsg').className='helper'; return; }
    const chosen=document.querySelector('input[name="actSize"]:checked');
    if(!chosen){ el('verifyMsg').textContent='Actual ‡§ï‡•á ‡§≤‡§ø‡§è Big/Small ‡§ö‡•Å‡§®‡•á‡§Ç.'; el('verifyMsg').className='helper'; return; }
    const actual=chosen.value; const pred=(+pick>=5)?'big':'small'; const win=(actual===pred);
    if(win){ el('verifyMsg').textContent=`WIN ‚úî ${pred.toUpperCase()}`; el('verifyMsg').className='win'; }
    else{ el('verifyMsg').textContent=`LOSS ‚úò picked ${pred.toUpperCase()} ‚Ä¢ actual ${actual.toUpperCase()}`; el('verifyMsg').className='lose'; }
    if(el('learnOn').checked){ const s=loadSize(); if(actual==='small') s[0]++; else s[1]++; saveSize(s); }
  });

  // default chart
  renderChart(Array(10).fill(0.1));
});
</script>
</body>
</html>
